<?xml version="1.0" encoding="UTF-8"?>
<thing:thing-descriptions bindingId="sunsynk"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:thing="https://openhab.org/schemas/thing-description/v1.0.0"
	xsi:schemaLocation="https://openhab.org/schemas/thing-description/v1.0.0 https://openhab.org/schemas/thing-description-1.0.0.xsd">

	<bridge-type id="account">
		<label>SunSynk Account</label>
		<description>Access to SunSynk Account. Used to discover plants and inverters tied to account.</description>
		<properties>
			<property name="vendor">SunSynk</property>
		</properties>
		<config-description>
			<parameter name="email" type="text" required="true">
				<label>E-mail Address</label>
				<description>E-mail address for your SunSynk Connect account.</description>
				<context>email</context>
			</parameter>
			<parameter name="password" type="text" required="true">
				<label>Password</label>
				<description>Password for your SunSynk Connect account.</description>
				<context>password</context>
			</parameter>
		</config-description>

	</bridge-type>

	<thing-type id="inverter">
		<supported-bridge-type-refs>
			<bridge-type-ref id="account"/>
		</supported-bridge-type-refs>
		<label>SunSynk Inverter</label>
		<description>Inverter thing for SunSynk Binding.</description>

		<channels>
			<channel id="interval-1-grid-charge" typeId="grid-charge"/>
			<channel id="interval-1-grid-time" typeId="grid-time"/>
			<channel id="interval-1-grid-capacity" typeId="battery-target"/>
			<channel id="interval-1-grid-power-limit" typeId="power-charge-limit"/>
			<channel id="interval-2-grid-charge" typeId="grid-charge"/>
			<channel id="interval-2-grid-time" typeId="grid-time"/>
			<channel id="interval-2-grid-capacity" typeId="battery-target"/>
			<channel id="interval-2-grid-power-limit" typeId="power-charge-limit"/>
			<channel id="interval-3-grid-charge" typeId="grid-charge"/>
			<channel id="interval-3-grid-time" typeId="grid-time"/>
			<channel id="interval-3-grid-capacity" typeId="battery-target"/>
			<channel id="interval-3-grid-power-limit" typeId="power-charge-limit"/>
			<channel id="interval-4-grid-charge" typeId="grid-charge"/>
			<channel id="interval-4-grid-time" typeId="grid-time"/>
			<channel id="interval-4-grid-capacity" typeId="battery-target"/>
			<channel id="interval-4-grid-power-limit" typeId="power-charge-limit"/>
			<channel id="interval-5-grid-charge" typeId="grid-charge"/>
			<channel id="interval-5-grid-time" typeId="grid-time"/>
			<channel id="interval-5-grid-capacity" typeId="battery-target"/>
			<channel id="interval-5-grid-power-limit" typeId="power-charge-limit"/>
			<channel id="interval-6-grid-charge" typeId="grid-charge"/>
			<channel id="interval-6-grid-time" typeId="grid-time"/>
			<channel id="interval-6-grid-capacity" typeId="battery-target"/>
			<channel id="interval-6-grid-power-limit" typeId="power-charge-limit"/>
			<channel id="interval-1-gen-charge" typeId="gen-charge"/>
			<channel id="interval-2-gen-charge" typeId="gen-charge"/>
			<channel id="interval-3-gen-charge" typeId="gen-charge"/>
			<channel id="interval-4-gen-charge" typeId="gen-charge"/>
			<channel id="interval-5-gen-charge" typeId="gen-charge"/>
			<channel id="interval-6-gen-charge" typeId="gen-charge"/>
			<channel id="battery-SOC" typeId="system.battery-level"/>
			<channel id="battery-grid-voltage" typeId="system.electric-voltage"/>
			<channel id="battery-grid-current" typeId="system.electric-current"/>
			<channel id="battery-grid-power" typeId="system.electric-power"/>
			<channel id="battery-temperature" typeId="system.indoor-temperature"/>
			<channel id="inverter-ac-temperature" typeId="system.indoor-temperature"/>
			<channel id="inverter-dc-temperature" typeId="system.indoor-temperature"/>
			<channel id="inverter-grid-power" typeId="system.electric-power"/>
			<channel id="inverter-grid-voltage" typeId="system.electric-voltage"/>
			<channel id="inverter-grid-current" typeId="system.electric-current"/>
			<channel id="inverter-solar-energy-today" typeId="system.electric-energy"/>
			<channel id="inverter-solar-energy-total" typeId="system.electric-energy"/>
			<channel id="inverter-solar-power-now" typeId="system.electric-current"/>
			<channel id="inverter-control-timer" typeId="control-timer"/>
			<channel id="inverter-control-energy-pattern" typeId="control-pattern"/>
			<channel id="inverter-control-work-mode" typeId="control-work-mode"/>
		</channels>

		<properties>
			<property name="vendor">SunSynk</property>
		</properties>

		<representation-property>sn</representation-property>

		<config-description>
			<parameter name="sn" type="text" required="true">
				<label>Inverter Serial Number</label>
				<description>Serial number of the inverter from Sun Synk Connect.</description>
			</parameter>
			<parameter name="alias" type="text" required="true">
				<label>Inverter Name</label>
				<description>Name of inverter from Sun Synk Connect.</description>
			</parameter>
			<parameter name="refresh" type="integer" required="true">
				<label>Refresh Interval</label>
				<description>Time in seconds to retrieve status from Sun Synk Connect services. Greater than 60 seconds.</description>
				<default>60</default>
				<advanced>true</advanced>
			</parameter>
		</config-description>

	</thing-type>

	<channel-type id="grid-time" advanced="true">
		<item-type>DateTime</item-type>
		<label>Grid Charge Time</label>
		<description>"Grid charging interval start time. Use 24hr time 00:00 to 23:55 are valid in 5 min increments with
			leading zero
			on the hour and minute. Interval times must be in ascending order."</description>
		<state readOnly="false"/> <!--- pattern="%1$tH:%1$tM"/> -->
	</channel-type>

	<channel-type id="grid-charge" advanced="true">
		<item-type>Switch</item-type>
		<label>Grid Charge</label>
		<description>Charge the inverter battery from the grid during this interval.</description>
		<state readOnly="false" pattern="%s"/>
	</channel-type>

	<channel-type id="gen-charge" advanced="true">
		<item-type>Switch</item-type>
		<label>Generator (AUX) Charge</label>
		<description>Charge the inverter battery from the generator (auxilary) during this interval.</description>
		<state readOnly="false" pattern="%s"/>
	</channel-type>

	<channel-type id="battery-target" advanced="true">
		<item-type>Number</item-type>
		<label>Target Charge Level</label>
		<description>The desired charge level of the battery (%).</description>
		<category>Battery</category>
		<state min="0" max="100" step="1" pattern="%d" readOnly="false"/>
	</channel-type>

	<channel-type id="power-charge-limit" advanced="true">
		<item-type>Number</item-type>
		<label>Maximum Charge Rate</label>
		<description>maximum charge power desired (limited by inverter capability).</description>
		<category>Inverter</category>
		<state min="0" max="100" step="1" pattern="%d %unit%" readOnly="false"/>
	</channel-type>

	<channel-type id="control-timer" advanced="true">
		<item-type>Switch</item-type>
		<label>System Timer</label>
		<description>Use the system mode timer to control battery charge discharge.</description>
		<state readOnly="false" pattern="%s"/>
	</channel-type>

	<channel-type id="control-pattern" advanced="true">
		<item-type>String</item-type>
		<label>System Energy Pattern</label>
		<description>Set the system mode energy pattern to '0' Priority Battery or '1' Priority Load.</description>
		<command>
			<options>
				<option value="0">Priority Battery</option>
				<option value="1">Priority Load</option>
			</options>
		</command>
	</channel-type>

	<channel-type id="control-work-mode" advanced="true">
		<item-type>String</item-type>
		<label>System Work Mode</label>
		<description>Set the work mode to '0' Selling First; '1' Zero-Export + Limted to Load or '2' Limited to Home.</description>
		<command>
			<options>
				<option value="0">Selling First</option>
				<option value="1">"Zero-Export + Limted to Load"</option>
				<option value="2">Limited to Home</option>
			</options>
		</command>
	</channel-type>

</thing:thing-descriptions>
